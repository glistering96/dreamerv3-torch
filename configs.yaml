defaults:
  logdir: /home/user/dreamerv3-torch/logdir
  traindir: ''
  evaldir: ''
  offline_traindir: ''
  offline_evaldir: ''
  seed: 0
  deterministic_run: False
  steps: 1e6
  parallel: False
  eval_every: 1e4
  eval_episode_num: 1
  log_every: 100
  reset_every: 0
  dataset_size: 0
  gpu_growth: True
  precision: 16
  debug: False
  expl_behavior: greedy
  expl_until: 0
  unimix_ratio: 0.01
  initial: learned
  device: cuda
  kl_free: 1.0
  dyn_scale: 0.5
  rep_scale: 0.1
  compile: False
  pretrain: 100
  
  # Optimization (Flattened)
  opt: adam
  model_lr: 2e-4
  actor_lr: 1e-4
  critic_lr: 1e-4
  opt_eps: 1e-8
  grad_clip: 100
  weight_decay: 0.0
  
  # Hyperparameters
  discount: 0.99
  discount_lambda: 0.95
  imag_horizon: 10
  imag_gradient: dynamics
  imag_gradient_mix: 0.5
  eval_state_mean: False
  
  # Environment
  task: tsp_20
  size: [64, 64]
  envs: 1
  action_repeat: 1
  time_limit: 100
  grayscale: False
  prefill: 2500
  eval_noise: 0.0
  clip_rewards: 'identity'
  
  # Model
  dyn_stoch: 32
  dyn_deter: 512
  dyn_hidden: 512
  dyn_rec_depth: 1
  dyn_discrete: 32
  dyn_mean_act: none
  dyn_std_act: sigmoid2
  dyn_min_std: 0.1
  grad_heads: [decoder, reward, cont]
  units: 512
  act: SiLU
  norm: True
  encoder:
    mlp_keys: '.*'
    cnn_keys: 'image'
    act: SiLU
    norm: True
    cnn_depth: 32
    kernel_size: 4
    minres: 4
    mlp_layers: 2
    mlp_units: 512
    symlog_inputs: True
  decoder:
    mlp_keys: '.*'
    cnn_keys: 'image'
    act: SiLU
    norm: True
    cnn_depth: 32
    kernel_size: 4
    minres: 4
    mlp_layers: 2
    mlp_units: 512
    cnn_sigmoid: False
    image_dist: mse
    vector_dist: symlog_mse
    outscale: 1.0
  reward_head:
    layers: 2
    dist: symlog_disc
    loss_scale: 1.0
    outscale: 0.0
  cont_head:
    layers: 2
    loss_scale: 1.0
    outscale: 1.0
  mask_head:
    layers: 2
    loss_scale: 1.0
    outscale: 1.0
  
  # Actor-Critic (Note: actor args are nested but some might be flat?)
  # models.py uses config.actor["layers"] so this is correct.
  actor:
    layers: 2
    dist: onehot
    std: 1.0
    min_std: 0.1
    max_std: 1.0
    temp: 0.1
    unimix_ratio: 0.01
    outscale: 1.0
    entropy: 1e-2
    lr: 3e-4
    eps: 1e-5
    grad_clip: 10
  critic:
    layers: 2
    dist: symlog_disc
    outscale: 0.0
    slow_target: True
    slow_target_update: 100
    slow_target_fraction: 1.0
    lr: 1e-4
    eps: 1e-5
    grad_clip: 100
  
  # Sizes
  batch_size: 16
  batch_length: 64
  train_ratio: 512
  
  # Other
  video_pred_log: False
  reward_EMA: True

tsp_attn:
  task: tsp_20
  encoder:
    attn_type: attention
    attn_num_nodes: 20
  actor:
    type: tsp_pointer
    unimix_ratio: 0.01
  mask_simulation: True  # Enable our new feature

size50k:
  dyn_stoch: 32
  dyn_deter: 200
  dyn_hidden: 200
  units: 200
  encoder:
    mlp_units: 200
  decoder:
    mlp_units: 200
